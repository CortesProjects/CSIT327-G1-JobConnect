{% extends "dashboard/employer/employer_dashboard_base.html" %}
{% load static %}

{% block extra_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/dashboard/employer/employer_post_job.css' %}">
{% endblock %}

{% block dashboard_content %}
<div class="post-job-container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <a href="{% url 'dashboard:dashboard' %}"><i class="fas fa-home"></i> Dashboard</a>
        <span class="separator">›</span>
        <a href="{% url 'dashboard:employer_my_jobs' %}">My Jobs</a>
        <span class="separator">›</span>
        <a href="{% url 'jobs:job_detail' job.id %}">{{ job.title }}</a>
        <span class="separator">›</span>
        <span class="current">Edit Job</span>
    </div>
    
    <h1 class="page-title">Edit Job</h1>
    
    <!-- Edit Window Notice -->
    <div class="alert alert-info" style="margin-bottom: 20px;">
        <i class="fas fa-info-circle"></i>
        You can edit this job for <strong>{{ days_remaining }} more day{% if days_remaining != 1 %}s{% endif %}</strong> 
        (posted {{ days_since_posted }} day{% if days_since_posted != 1 %}s{% endif %} ago).
        Jobs can only be edited within 7 days of posting.
    </div>
    
    <form method="post" class="post-job-form" id="jobPostForm" novalidate>
        {% csrf_token %}
        
        <!-- Job Title -->
        <div class="form-section">
            <div class="form-group full-width">
                <label for="job_title">Job Title</label>
                {{ form.title }}
                <span class="error-message" id="job_title_error">{% if form.title.errors %}{{ form.title.errors|join:", " }}{% endif %}</span>
            </div>
        </div>

        <!-- Tags, Job Role, and Location -->
        <div class="form-section two-columns">
            <div class="form-group">
                <label for="tags">Tags</label>
                {{ form.tags }}
            </div>
            <div class="form-group">
                <label for="category">Job Category <span class="required">*</span></label>
                {{ form.category }}
                <span class="error-message" id="category_error">{% if form.category.errors %}{{ form.category.errors|join:", " }}{% endif %}</span>
            </div>
        </div>
        
        <!-- Location -->
        <div class="form-section">
            <div class="form-group full-width">
                <label for="location">Location <span class="required">*</span></label>
                {{ form.location }}
                <span class="error-message" id="location_error">{% if form.location.errors %}{{ form.location.errors|join:", " }}{% endif %}</span>
            </div>
        </div>

        <!-- Salary -->
        <div class="form-section three-columns">
            <div class="form-group">
                <label for="min_salary">Minimum Salary</label>
                {{ form.min_salary }}
                <span class="error-message" id="min_salary_error">{% if form.min_salary.errors %}{{ form.min_salary.errors|join:", " }}{% endif %}</span>
            </div>
            <div class="form-group">
                <label for="max_salary">Maximum Salary</label>
                {{ form.max_salary }}
                <span class="error-message" id="max_salary_error">{% if form.max_salary.errors %}{{ form.max_salary.errors|join:", " }}{% endif %}</span>
            </div>
            <div class="form-group">
                <label for="salary_type">Salary Type</label>
                {{ form.salary_type }}
            </div>
        </div>

        <!-- Advanced Information -->
        <div class="form-section three-columns">
            <div class="form-group">
                <label for="education">Education</label>
                {{ form.education }}
            </div>
            <div class="form-group">
                <label for="experience">Experience</label>
                {{ form.experience }}
            </div>
            <div class="form-group">
                <label for="job_type">Job Type</label>
                {{ form.job_type }}
            </div>
        </div>

        <div class="form-section three-columns">
            <div class="form-group">
                <label for="vacancies">Vacancies</label>
                {{ form.vacancies }}
                <span class="error-message" id="vacancies_error">{% if form.vacancies.errors %}{{ form.vacancies.errors|join:", " }}{% endif %}</span>
            </div>
            <div class="form-group">
                <label for="expiration_date">Application Deadline <span class="required">*</span></label>
                {{ form.expiration_date }}
                <span class="error-message" id="expiration_date_error">{% if form.expiration_date.errors %}{{ form.expiration_date.errors|join:", " }}{% endif %}</span>
            </div>
            <div class="form-group">
                <label for="job_level">Job Level</label>
                {{ form.job_level }}
            </div>
        </div>

        <!-- Description & Responsibility Section -->
        <div class="form-section">
            <h3 class="section-title">Description & Responsibility</h3>
            
            <div class="form-group full-width">
                <label for="description">Description <span class="required">*</span></label>
                <div class="editor-toolbar">
                    <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                        <i class="fas fa-bold"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                        <i class="fas fa-italic"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="underline" title="Underline">
                        <i class="fas fa-underline"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="strikethrough" title="Strikethrough">
                        <i class="fas fa-strikethrough"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="link" title="Insert Link">
                        <i class="fas fa-link"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                        <i class="fas fa-list-ol"></i>
                    </button>
                </div>
                <div contenteditable="true" class="editor-content" id="description" data-placeholder="Add your job description..."></div>
                {{ form.description }}
                <span class="error-message" id="description_error">{% if form.description.errors %}{{ form.description.errors|join:", " }}{% endif %}</span>
            </div>

            <div class="form-group full-width">
                <label for="responsibilities">Responsibilities</label>
                <div class="editor-toolbar">
                    <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                        <i class="fas fa-bold"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                        <i class="fas fa-italic"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="underline" title="Underline">
                        <i class="fas fa-underline"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="strikethrough" title="Strikethrough">
                        <i class="fas fa-strikethrough"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="link" title="Insert Link">
                        <i class="fas fa-link"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                        <i class="fas fa-list-ol"></i>
                    </button>
                </div>
                <div contenteditable="true" class="editor-content" id="responsibilities" data-placeholder="Add your job responsibilities..."></div>
                {{ form.responsibilities }}
                <span class="error-message" id="responsibilities_error">{% if form.responsibilities.errors %}{{ form.responsibilities.errors|join:", " }}{% endif %}</span>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
            <a href="{% url 'jobs:job_detail' job.id %}" class="btn-cancel-form">
                <i class="fas fa-times"></i> Cancel
            </a>
            <button type="submit" class="btn-submit-form">
                <i class="fas fa-check"></i> Update Job
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script src="{% static 'js/dashboard/employer/employer_post_job.js' %}"></script>
{# Inline JS moved to `static/js/dashboard/employer/employer_post_job.js` #}
{% endblock %}
