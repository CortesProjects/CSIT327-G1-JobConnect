{% extends "dashboard/employer/employer_dashboard_base.html" %}
{% load static %}

{% block extra_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/dashboard/employer/employer_post_job.css' %}">
{% endblock %}

{% block dashboard_content %}
<div class="post-job-container">
    <h1 class="page-title">Post a job</h1>
    
    {% if messages %}
    <div class="messages-container" id="messagesContainer">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            <i class="fas fa-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'error' %}exclamation-circle{% else %}info-circle{% endif %}"></i>
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <form method="post" class="post-job-form" id="jobPostForm" novalidate>
        {% csrf_token %}
        
        <!-- Job Title -->
        <div class="form-section">
            <div class="form-group full-width">
                <label for="job_title">Job Title</label>
                <!-- name should match model field 'title' so Django form receives the value -->
                <input type="text" id="job_title" name="title" placeholder="Add job title, role, vacancies etc..." required>
                <span class="error-message" id="job_title_error">{% if form.title.errors %}{{ form.title.errors|join:", " }}{% endif %}</span>
            </div>
        </div>

        <!-- Tags, Job Role, and Location -->
        <div class="form-section two-columns">
            <div class="form-group">
                <label for="tags">Tags</label>
                <input type="text" id="tags" name="tags" placeholder="Job keyword, tags etc...">
            </div>
            <div class="form-group">
                <label for="job_role">Job Role <span class="required">*</span></label>
                <select id="job_role" name="job_role" required>
                    <option value="">Select...</option>
                    <option value="frontend">Frontend Developer</option>
                    <option value="backend">Backend Developer</option>
                    <option value="fullstack">Full Stack Developer</option>
                    <option value="designer">UI/UX Designer</option>
                    <option value="data_scientist">Data Scientist</option>
                    <option value="project_manager">Project Manager</option>
                    <option value="marketing">Marketing Specialist</option>
                    <option value="sales">Sales Executive</option>
                    <option value="hr">HR Manager</option>
                    <option value="other">Other</option>
                </select>
                <span class="error-message" id="job_role_error">{% if form.job_role.errors %}{{ form.job_role.errors|join:", " }}{% endif %}</span>
            </div>
        </div>
        
        <!-- Location -->
        <div class="form-section">
            <div class="form-group full-width">
                <label for="location">Location <span class="required">*</span></label>
                <input type="text" id="location" name="location" placeholder="Enter job location (e.g., New York, USA)" required>
                <span class="error-message" id="location_error">{% if form.location.errors %}{{ form.location.errors|join:", " }}{% endif %}</span>
            </div>
        </div>

        <!-- Salary Section -->
        <div class="form-section">
            <h3 class="section-title">Salary</h3>
            <div class="salary-row">
                <div class="form-group">
                    <label for="min_salary">Min Salary</label>
                    <div class="input-with-currency">
                        <input type="number" id="min_salary" name="min_salary" placeholder="Minimum salary..." required>
                        <span class="error-message" id="min_salary_error">{% if form.min_salary.errors %}{{ form.min_salary.errors|join:", " }}{% endif %}</span>
                        <span class="currency">USD</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="max_salary">Max Salary</label>
                    <div class="input-with-currency">
                        <input type="number" id="max_salary" name="max_salary" placeholder="Maximum salary..." required>
                        <span class="error-message" id="max_salary_error">{% if form.max_salary.errors %}{{ form.max_salary.errors|join:", " }}{% endif %}</span>
                        <span class="currency">USD</span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="salary_type">Salary Type</label>
                    <select id="salary_type" name="salary_type" required>
                        <option value="">Select...</option>
                        <option value="hourly">Hourly</option>
                        <option value="monthly">Monthly</option>
                        <option value="yearly">Yearly</option>
                    </select>
                    <span class="error-message" id="salary_type_error">{% if form.salary_type.errors %}{{ form.salary_type.errors|join:", " }}{% endif %}</span>
                </div>
            </div>
        </div>

        <!-- Advance Information Section -->
        <div class="form-section">
            <h3 class="section-title">Advance Information</h3>
            <div class="advance-info-row">
                <div class="form-group">
                    <label for="education">Education</label>
                    <select id="education" name="education" required>
                        <option value="">Select...</option>
                        <option value="high_school">High School</option>
                        <option value="associate">Associate Degree</option>
                        <option value="bachelor">Bachelor's Degree</option>
                        <option value="master">Master's Degree</option>
                        <option value="phd">PhD</option>
                    </select>
                    <span class="error-message" id="education_error">{% if form.education.errors %}{{ form.education.errors|join:", " }}{% endif %}</span>
                </div>
                <div class="form-group">
                    <label for="experience">Experience</label>
                    <select id="experience" name="experience" required>
                        <option value="">Select...</option>
                        <option value="fresher">Fresher</option>
                        <option value="1-2">1-2 years</option>
                        <option value="3-5">3-5 years</option>
                        <option value="5-10">5-10 years</option>
                        <option value="10+">10+ years</option>
                    </select>
                    <span class="error-message" id="experience_error">{% if form.experience.errors %}{{ form.experience.errors|join:", " }}{% endif %}</span>
                </div>
                <div class="form-group">
                    <label for="job_type">Job Type</label>
                    <select id="job_type" name="job_type" required>
                        <option value="">Select...</option>
                        <option value="full_time">Full Time</option>
                        <option value="part_time">Part Time</option>
                        <option value="contract">Contract</option>
                        <option value="internship">Internship</option>
                        <option value="freelance">Freelance</option>
                    </select>
                    <span class="error-message" id="job_type_error">{% if form.job_type.errors %}{{ form.job_type.errors|join:", " }}{% endif %}</span>
                </div>
            </div>
            <div class="advance-info-row second-row">
                <div class="form-group">
                    <label for="vacancies">Vacancies</label>
                    <select id="vacancies" name="vacancies" required>
                        <option value="">Select...</option>
                        <option value="1">1</option>
                        <option value="2-5">2-5</option>
                        <option value="6-10">6-10</option>
                        <option value="10+">10+</option>
                    </select>
                    <span class="error-message" id="vacancies_error">{% if form.vacancies.errors %}{{ form.vacancies.errors|join:", " }}{% endif %}</span>
                </div>
                <div class="form-group">
                    <label for="expiration_date">Expiration Date</label>
                    <!-- Use HTML date input so the browser posts a YYYY-MM-DD value that Django can parse -->
                    <input type="date" id="expiration_date" name="expiration_date" required>
                    <span class="error-message" id="expiration_date_error">{% if form.expiration_date.errors %}{{ form.expiration_date.errors|join:", " }}{% endif %}</span>
                </div>
                <div class="form-group">
                    <label for="job_level">Job Level</label>
                    <select id="job_level" name="job_level" required>
                        <option value="">Select...</option>
                        <option value="entry">Entry Level</option>
                        <option value="mid">Mid Level</option>
                        <option value="senior">Senior Level</option>
                        <option value="lead">Lead</option>
                        <option value="manager">Manager</option>
                        <option value="executive">Executive</option>
                    </select>
                    <span class="error-message" id="job_level_error">{% if form.job_level.errors %}{{ form.job_level.errors|join:", " }}{% endif %}</span>
                </div>
            </div>
        </div>

        <!-- Description & Responsibility Section -->
        <div class="form-section">
            <h3 class="section-title">Description & Responsibility</h3>
            
            <div class="form-group full-width">
                <label for="description">Description</label>
                <div class="editor-toolbar">
                    <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                        <i class="fas fa-bold"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                        <i class="fas fa-italic"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="underline" title="Underline">
                        <i class="fas fa-underline"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="strikethrough" title="Strikethrough">
                        <i class="fas fa-strikethrough"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="link" title="Insert Link">
                        <i class="fas fa-link"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                        <i class="fas fa-list-ol"></i>
                    </button>
                </div>
                <div contenteditable="true" class="editor-content" id="description" data-placeholder="Add your job description..."></div>
                <input type="hidden" name="description" id="description_hidden">
                <span class="error-message" id="description_error">{% if form.description.errors %}{{ form.description.errors|join:", " }}{% endif %}</span>
            </div>

            <div class="form-group full-width">
                <label for="responsibilities">Responsibilities</label>
                <div class="editor-toolbar">
                    <button type="button" class="toolbar-btn" data-command="bold" title="Bold">
                        <i class="fas fa-bold"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="italic" title="Italic">
                        <i class="fas fa-italic"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="underline" title="Underline">
                        <i class="fas fa-underline"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="strikethrough" title="Strikethrough">
                        <i class="fas fa-strikethrough"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="link" title="Insert Link">
                        <i class="fas fa-link"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                        <i class="fas fa-list-ol"></i>
                    </button>
                </div>
                <div contenteditable="true" class="editor-content" id="responsibilities" data-placeholder="Add your job responsibilities..."></div>
                <input type="hidden" name="responsibilities" id="responsibilities_hidden">
                <span class="error-message" id="responsibilities_error">{% if form.responsibilities.errors %}{{ form.responsibilities.errors|join:", " }}{% endif %}</span>
            </div>
        </div>

        <!-- Submit Button -->
        <div class="form-actions">
            <button type="submit" class="submit-btn">
                Post Job
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </form>
</div>

<!-- Success Modal -->
<div id="successModal" class="modal">
    <div class="modal-content">
        <button class="modal-close" id="closeModal">&times;</button>
        <div class="modal-body">
            <div class="modal-icon">ðŸŽ‰</div>
            <h2 class="modal-title">Congratulation, Your Job is successfully posted!</h2>
            <p class="modal-message">You can manage your form my-jobs section in your dashboard</p>
            <a href="{% url 'dashboard:employer_my_jobs' %}" class="modal-btn">
                View Jobs
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>
</div>

<script src="{% static 'js/dashboard/employer/employer_post_job.js' %}"></script>
{% endblock %}
